<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>æˆ‘çš„è¡Œç¨‹æœ¬ï½œSydney Diary V2.3</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --primary-color: #111827;
      --secondary-color: #374151;
      --accent-color: #2563eb;
      --bg-color: #f5f5f7;
      --card-bg: #ffffff;
      --text-title: #111827;
      --text-subtitle: #4b5563;
      --text-body: #374151;
      --text-muted: #6b7280;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: var(--bg-color);
      color: var(--text-body);
    }

    a {
      color: var(--accent-color);
      text-decoration: none;
    }

    .app {
      max-width: 1100px;
      margin: 0 auto;
      padding: 16px;
    }

    /* ========= HEADER ========= */
    .top-bar {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 12px;
    }

    #sidebar-toggle {
      border: none;
      background: var(--card-bg);
      border-radius: 999px;
      width: 32px;
      height: 32px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.06);
      cursor: pointer;
    }

    #sidebar-toggle span {
      display: block;
      width: 14px;
      height: 2px;
      background: var(--primary-color);
      position: relative;
    }

    #sidebar-toggle span::before,
    #sidebar-toggle span::after {
      content: "";
      position: absolute;
      left: 0;
      width: 14px;
      height: 2px;
      background: var(--primary-color);
    }

    #sidebar-toggle span::before { top: -4px; }
    #sidebar-toggle span::after { top: 4px; }

    .top-bar-main {
      flex: 1;
    }

    .app-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-title);
      margin-bottom: 4px;
    }

    .subtitle {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 8px;
    }

    .time-weather-row {
      display: flex;
      flex-wrap: nowrap;
      gap: 8px;
      align-items: center;
      overflow-x: auto;
    }

    .time-block,
    .weather-block {
      background: var(--card-bg);
      border-radius: 999px;
      padding: 6px 10px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.04);
      font-size: 11px;
      color: var(--text-subtitle);
      flex-shrink: 0;
    }

    .time-label {
      font-weight: 600;
      color: var(--primary-color);
    }

    .time-main {
      font-variant-numeric: tabular-nums;
    }

    .icon-circle {
      width: 16px;
      height: 16px;
      border-radius: 999px;
      border: 1.5px solid var(--primary-color);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 9px;
    }

    .icon-clock::before {
      content: "âŒš";
      font-size: 9px;
      transform: translateY(-0.5px);
    }

    .icon-weather::before {
      content: "â˜";
      font-size: 9px;
      transform: translateY(-0.5px);
    }

    /* ========= OVERLAY & LAYOUT ========= */
    #sidebar-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.3);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease;
      z-index: 9;
    }

    #sidebar-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .layout {
      display: flex;
      gap: 16px;
      align-items: flex-start;
      position: relative;
    }

    /* ========= SIDEBAR ========= */
    .sidebar {
      width: 260px;
      background: var(--card-bg);
      border-radius: 12px;
      padding: 14px 12px 28px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
      gap: 12px;
      position: relative;
      z-index: 10;
    }

    .sidebar-trip-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 4px;
    }

    .sidebar-trip-dates {
      font-size: 12px;
      color: var(--text-muted);
    }

    .sidebar-section-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--secondary-color);
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .sidebar-section-title span.icon-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent-color);
    }

    /* Day list */
    #day-list {
      list-style: none;
      margin: 0;
      padding: 0;
    }

/* å´é‚Šæ¬„ï¼šå¤©æ•¸åˆ—è¡¨ï¼ˆ3 æ¬„å›ºå®šå°é½Šï¼Œä¸è¶…å‡ºæ¬„å¯¬ï¼‰ */
.day-list-item {
  font-size: 11px;
  padding: 4px 8px;
  border-radius: 999px;
  cursor: pointer;
  display: grid;
  grid-template-columns: 60px 52px minmax(0, 1fr); /* å·¦ï¼šDayï¼å‡ºç™¼æ—¥ï¼Œä¸­ï¼šæ—¥æœŸï¼Œå³ï¼šä¸»é¡Œ */
  align-items: center;
  column-gap: 4px;
  color: var(--text-body);
}

.day-list-item .day-col1,
.day-list-item .day-col2 {
  white-space: nowrap;                /* Day / æ—¥æœŸ ä¸€å¾‹ä¸€è¡Œ */
}

.day-list-item .day-col3 {
  min-width: 0;
  white-space: nowrap;                /* ä¸»é¡Œéé•·å°± â€¦ */
  overflow: hidden;
  text-overflow: ellipsis;
}

    .day-list-item.active {
      background: var(--primary-color);
      color: #fff;
    }

    /* Cards (FX / Theme) */
    .card {
      background: var(--bg-color);
      border-radius: 12px;
      padding: 10px;
      font-size: 11px;
    }

    /* FX card */
    .fx-main-line {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 6px;
      font-size: 11px;
      color: var(--text-subtitle);
    }

    .fx-rate-label {
      font-weight: 500;
    }

    .icon-btn {
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #ffffff;
      font-size: 11px;
      padding: 2px 6px;
      cursor: pointer;
      color: var(--accent-color);
    }

    .icon-btn:active {
      transform: translateY(1px);
    }

    .fx-row {
      display: flex;
      align-items: center;
      gap: 4px;
      margin-bottom: 4px;
    }

    .fx-row label {
      min-width: 44px;
    }

    .fx-row input[type="number"] {
      flex: 1;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      padding: 4px 6px;
      font-size: 11px;
    }

    .fx-tagline {
      font-size: 10px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    /* Theme card */
    .theme-row {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 6px;
      position: relative;
    }

    .theme-row label {
      min-width: 40px;
      font-size: 11px;
    }

    .theme-preview {
      flex: 1;
      height: 18px;
      border-radius: 999px;
      background: var(--primary-color);
      border: 1px solid #e5e7eb;
    }

    .theme-color-input {
      position: absolute;
      top: 0;
      left: 40px; /* è·Ÿ label å°é½Šå³å´ */
      right: 0;
      bottom: 0;
      opacity: 0;
      cursor: pointer;
    }

    .theme-row input[type="range"] {
      flex: 1;
    }

    .theme-row input[type="text"] {
      flex: 1;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      padding: 4px 6px;
      font-size: 11px;
      background: #f9fafb;
    }

    .small-button {
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      cursor: pointer;
    }

    /* ========= CONTENT ========= */
    .content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 1;
    }

    #day-header,
#day-schedule,
#day-meals {
  background: var(--card-bg);
  border-radius: 12px;
  padding: 14px 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  min-height: 110px;
  width: 100%;          /* âœ… ä¸€å¾‹ä½”æ»¿å…§å®¹å¯¬åº¦ */
  box-sizing: border-box;
}
    /* è®“ä¸‰å¼µç™½åº•å¡çœŸçš„è²¼é½Šå…§å®¹å€ï¼Œä¸è¦ç¸®é€²å» */
.content > section {
  width: 100%;
}

    .day-banner {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      font-size: 12px;
    }

    .banner-label {
      font-weight: 600;
      margin-right: 4px;
      color: var(--secondary-color);
    }

    .banner-hotel-name {
      color: var(--primary-color);
      font-weight: 500;
    }

    .banner-hotel-link {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      color: var(--accent-color);
    }

    .icon-map {
      width: 14px;
      height: 14px;
      position: relative;
      display: inline-block;
    }

    .icon-map::before {
      content: "";
      position: absolute;
      width: 9px;
      height: 9px;
      border-radius: 50%;
      background: var(--accent-color);
      top: 0px;
      left: 2.5px;
    }

    .icon-map::after {
      content: "";
      position: absolute;
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: #ffffff;
      top: 2.5px;
      left: 5px;
    }

    .day-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-title);
      margin-bottom: 4px;
    }

    .day-subtitle {
      font-size: 13px;
      color: var(--text-subtitle);
      margin-bottom: 6px;
    }

    .badge-row {
      margin-top: 4px;
    }

    .badge {
      display: inline-block;
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      background: #f3f4f6;
      color: var(--text-muted);
      margin-right: 4px;
    }

    .badge-highcal {
      background: #fef2f2;
      color: #b91c1c;
    }

    .section-title {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--secondary-color);
    }

    .schedule-row {
      display: grid;
      grid-template-columns: 80px 1fr;
      gap: 8px;
      padding: 8px 0;
      border-bottom: 1px dashed #e5e7eb;
    }

    .schedule-row:last-child {
      border-bottom: none;
    }

    .time-cell {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-subtitle);
    }

    .block-title {
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 2px;
      color: var(--text-title);
    }

    .block-detail {
      font-size: 12px;
      color: var(--text-body);
    }

    .block-meta {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 2px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .meals-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 8px;
    }

    .meal-card {
      padding: 10px;
      border-radius: 10px;
      background: #f9fafb;
    }

    .meal-title {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 4px;
      color: var(--secondary-color);
    }

    .meal-restaurant {
      font-size: 13px;
      margin-bottom: 2px;
      color: var(--text-title);
    }

    .meal-note {
      font-size: 12px;
      color: var(--text-body);
    }

    .meal-tag {
      display: inline-block;
      margin-top: 4px;
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 999px;
      background: #e5e7eb;
      color: #6b7280;
    }

    .meal-tag-reserve {
      background: #eff6ff;
      color: #1d4ed8;
    }

    /* ========= RESPONSIVE ========= */
    @media (max-width: 768px) {
      .layout {
        flex-direction: column;
      }

      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        transform: translateX(-100%);
        transition: transform 0.2s ease;
        border-radius: 0 12px 12px 0;
      }

      .sidebar.open {
        transform: translateX(0);
      }
    }

    @media (min-width: 769px) {
      #sidebar-overlay {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- HEADER -->
    <header>
      <div class="top-bar">
        <button id="sidebar-toggle" aria-label="é–‹å•Ÿå´é‚Šé¸å–®">
          <span></span>
        </button>
        <div class="top-bar-main">
          <div class="app-title">æˆ‘çš„è¡Œç¨‹æœ¬ï½œSydney Diary</div>
          <div class="subtitle">V2.3ï½œå–®æª”ç‰ˆï½œå·²è‡ªå‹•è¼‰å…¥è¡Œç¨‹ï¼Œä¸éœ€è¼¸å…¥å¯†ç¢¼</div>
          <div class="time-weather-row">
            <div class="time-block">
              <div class="icon-circle icon-clock"></div>
              <div>
                <div class="time-label">å°åŒ— TPE</div>
                <div class="time-main" id="time-tpe">--:--</div>
              </div>
            </div>
            <div class="time-block">
              <div class="icon-circle icon-clock"></div>
              <div>
                <div class="time-label">é›ªæ¢¨ SYD</div>
                <div class="time-main" id="time-syd">--:--</div>
              </div>
            </div>
            <div class="weather-block" id="weather-block">
              <div class="icon-circle icon-weather"></div>
              <div>
                <div class="time-label">é›ªæ¢¨å¤©æ°£</div>
                <div id="weather-main">è¼‰å…¥ä¸­â€¦</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- OVERLAY -->
    <div id="sidebar-overlay"></div>

    <!-- LAYOUT -->
    <div class="layout">
      <!-- SIDEBAR -->
      <aside class="sidebar" id="sidebar">
        <div>
          <div class="sidebar-trip-title" id="trip-title">é›ªæ¢¨è·¨å¹´ 10 æ—¥éŠ</div>
          <div class="sidebar-trip-dates" id="trip-dates">2025/12/23 â€“ 2026/01/02</div>
        </div>

        <div>
          <div class="sidebar-section-title">
            <span class="icon-dot"></span><span>ğŸ—“ å¤©æ•¸</span>
          </div>
          <ul id="day-list"></ul>
        </div>

        <div class="card">
          <div class="sidebar-section-title">
            <span class="icon-dot"></span><span>ğŸ’± åŒ¯ç‡æ›ç®—</span>
          </div>
          <div class="fx-main-line">
            <span class="fx-rate-label" id="fx-label">1 AUD â‰ˆ -- TWD</span>
            <button id="fx-refresh" class="icon-btn" type="button">âŸ³ æ›´æ–°</button>
          </div>
          <div class="fx-row">
            <label for="fx-aud">AUD</label>
            <input type="number" id="fx-aud" step="0.01">
          </div>
          <div class="fx-row">
            <label for="fx-twd">TWD</label>
            <input type="number" id="fx-twd" step="1">
          </div>
          <div class="fx-tagline" id="fx-tagline">
            åŒ¯ç‡ç”±ç¶²è·¯æ›´æ–°ï¼Œåƒ…ä¾›åƒè€ƒã€‚è¼¸å…¥ä»»ä¸€æ¬„ï¼Œå¦ä¸€é‚Šæœƒè‡ªå‹•å¹«ä½ ç®—ã€‚
          </div>
        </div>

        <div class="card">
          <div class="sidebar-section-title">
            <span class="icon-dot"></span><span>ğŸ¨ ä¸»é¡Œè‰²ç³»</span>
          </div>
          <div class="theme-row">
            <label for="theme-color">ä¸»è‰²</label>
            <div class="theme-preview" id="theme-preview"></div>
            <input type="color" id="theme-color" class="theme-color-input">
          </div>
          <div class="theme-row">
            <label>R</label>
            <input type="range" id="r-range" min="0" max="255">
          </div>
          <div class="theme-row">
            <label>G</label>
            <input type="range" id="g-range" min="0" max="255">
          </div>
          <div class="theme-row">
            <label>B</label>
            <input type="range" id="b-range" min="0" max="255">
          </div>
          <div class="theme-row">
            <label>è‰²ç¢¼</label>
            <input type="text" id="theme-hex" readonly>
          </div>
          <button id="reset-theme-btn" class="small-button">æ¢å¾©é è¨­</button>
        </div>
      </aside>

      <!-- CONTENT -->
      <main class="content">
        <section id="day-header"></section>
        <section id="day-schedule"></section>
        <section id="day-meals"></section>
      </main>
    </div>
  </div>

  <script>
    /* ========= é¡è‰²èˆ‡ä¸»é¡Œ ========= */
    function rgbToHex(r,g,b){
      function h(x){var s=x.toString(16);return s.length===1?"0"+s:s;}
      return "#"+h(r)+h(g)+h(b);
    }

    function hexToRgb(hex){
      hex = hex.replace("#","");
      var r = parseInt(hex.slice(0,2),16);
      var g = parseInt(hex.slice(2,4),16);
      var b = parseInt(hex.slice(4,6),16);
      return {r:r,g:g,b:b};
    }

    function mixWithWhite(r,g,b,ratio){
      return {
        r: Math.round(r + (255 - r)*ratio),
        g: Math.round(g + (255 - g)*ratio),
        b: Math.round(b + (255 - b)*ratio)
      };
    }

    function applyTheme(theme){
      var root = document.documentElement;
      root.style.setProperty("--primary-color", theme.primary);
      root.style.setProperty("--secondary-color", theme.secondary);
      root.style.setProperty("--accent-color", theme.accent);
      root.style.setProperty("--bg-color", theme.bg || "#f5f5f7");
      root.style.setProperty("--card-bg", "#ffffff");

      root.style.setProperty("--text-title", "#111827");
      root.style.setProperty("--text-subtitle", "#4b5563");
      root.style.setProperty("--text-body", "#374151");
      root.style.setProperty("--text-muted", "#6b7280");

      var colorInput = document.getElementById("theme-color");
      var rRange = document.getElementById("r-range");
      var gRange = document.getElementById("g-range");
      var bRange = document.getElementById("b-range");
      var hexInput = document.getElementById("theme-hex");

      if(colorInput) colorInput.value = theme.hex;
      if(rRange) rRange.value = theme.r;
      if(gRange) gRange.value = theme.g;
      if(bRange) bRange.value = theme.b;
      if(hexInput) hexInput.value = theme.hex.toUpperCase();
    }

    function defaultTheme(){
      var r=17,g=24,b=39;
      var secondaryRGB = mixWithWhite(r,g,b,0.25);
      var accentRGB = mixWithWhite(r,g,b,0.15);
      return {
        primary: "rgb("+r+","+g+","+b+")",
        secondary: "rgb("+secondaryRGB.r+","+secondaryRGB.g+","+secondaryRGB.b+")",
        accent: "rgb("+accentRGB.r+","+accentRGB.g+","+accentRGB.b+")",
        r:r,g:g,b:b,
        hex:"#111827",
        bg:"#f5f5f7"
      };
    }

    function computeThemeFromRGB(r,g,b){
      var secondaryRGB = mixWithWhite(r,g,b,0.25);
      var accentRGB = mixWithWhite(r,g,b,0.15);
      return {
        primary: "rgb("+r+","+g+","+b+")",
        secondary: "rgb("+secondaryRGB.r+","+secondaryRGB.g+","+secondaryRGB.b+")",
        accent: "rgb("+accentRGB.r+","+accentRGB.g+","+accentRGB.b+")",
        r:r,g:g,b:b,
        hex: rgbToHex(r,g,b),
        bg:"#f5f5f7"
      };
    }

    function initThemeUI(){
      var t = defaultTheme();
      applyTheme(t);

      var tc = document.getElementById("theme-color");
      var r  = document.getElementById("r-range");
      var g  = document.getElementById("g-range");
      var b  = document.getElementById("b-range");
      var reset = document.getElementById("reset-theme-btn");

      if(tc){
        tc.addEventListener("input", function(e){
          var hex = e.target.value;
          var rgb = hexToRgb(hex);
          var theme = computeThemeFromRGB(rgb.r,rgb.g,rgb.b);
          applyTheme(theme);
        });
      }

      [r,g,b].forEach(function(range){
        if(!range) return;
        range.addEventListener("input",function(){
          var rr = parseInt(r.value||"17",10);
          var gg = parseInt(g.value||"24",10);
          var bb = parseInt(b.value||"39",10);
          var theme = computeThemeFromRGB(rr,gg,bb);
          applyTheme(theme);
        });
      });

      if(reset){
        reset.addEventListener("click",function(){
          var t = defaultTheme();
          applyTheme(t);
        });
      }
    }

    /* ========= æ™‚é–“åˆ— ========= */
    function updateTimes(){
      try {
        var now = new Date();
        var tpe = new Intl.DateTimeFormat('zh-TW', {
          hour:'2-digit', minute:'2-digit', hour12:false, timeZone:'Asia/Taipei'
        }).format(now);
        var syd = new Intl.DateTimeFormat('zh-TW', {
          hour:'2-digit', minute:'2-digit', hour12:false, timeZone:'Australia/Sydney'
        }).format(now);
        document.getElementById("time-tpe").textContent = tpe;
        document.getElementById("time-syd").textContent = syd;
      } catch(e) {
        document.getElementById("time-tpe").textContent = "--:--";
        document.getElementById("time-syd").textContent = "--:--";
      }
    }

    /* ========= é›ªæ¢¨å³æ™‚å¤©æ°£ï¼ˆOpen-Meteoï¼‰ ========= */
    function fetchSydneyWeather(){
      var weatherMain = document.getElementById("weather-main");
      var url = "https://api.open-meteo.com/v1/forecast?latitude=-33.8688&longitude=151.2093&current_weather=true";
      fetch(url)
        .then(function(res){ return res.json(); })
        .then(function(data){
          if(!data || !data.current_weather){
            weatherMain.textContent = "æš«æ™‚ç„¡æ³•å–å¾—å¤©æ°£";
            return;
          }
          var cw = data.current_weather;
          var temp = cw.temperature;
          var wind = cw.windspeed;
          var code = cw.weathercode;
          var iconChar = "â˜";
          if(code === 0) iconChar = "â˜€";
          else if(code === 1 || code === 2) iconChar = "ğŸŒ¤";
          else if(code === 3) iconChar = "â˜";
          else if(code >= 51 && code <= 67) iconChar = "ğŸŒ¦";
          else if(code >= 71 && code <= 77) iconChar = "â„";
          else if(code >= 80 && code <= 82) iconChar = "ğŸŒ§";
          else if(code >= 95) iconChar = "â›ˆ";

          weatherMain.textContent =
            iconChar + " " + temp.toFixed(1) + "Â°Cï½œé¢¨ " + wind.toFixed(0) + " km/h";
        })
        .catch(function(){
          weatherMain.textContent = "è¼‰å…¥å¤±æ•—ï¼Œå¯é» Google æœå°‹å¤©æ°£";
        });
    }

    /* ========= åŒ¯ç‡æ›ç®—ï¼ˆè‡ªå‹•æ›´æ–°ï¼‹å¤±æ•— fallbackï¼‰ ========= */
    var fxRate = 20.00; // é è¨­å…ˆç•¶ 20

    function updateFxLabel(normal){
      var label = document.getElementById("fx-label");
      if(!label) return;
      if(normal){
        label.textContent = "1 AUD â‰ˆ " + fxRate.toFixed(2) + " TWD";
      }else{
        label.textContent = "1 AUD â‰ˆ " + fxRate.toFixed(2) + " TWDï¼ˆæ›´æ–°å¤±æ•—ï¼Œæš«ç”¨ 20 è¨ˆç®—ï¼‰";
      }
    }

    function fetchFxRate(){
      var label = document.getElementById("fx-label");
      var tagline = document.getElementById("fx-tagline");
      if(label) label.textContent = "åŒ¯ç‡æ›´æ–°ä¸­â€¦";

      fetch("https://api.exchangerate.host/latest?base=AUD&symbols=TWD")
        .then(function(res){ return res.json(); })
        .then(function(data){
          if(data && data.rates && data.rates.TWD){
            fxRate = data.rates.TWD;
            localStorage.setItem("sydDiaryFxRate", fxRate.toString());
            updateFxLabel(true);
            if(tagline){
              tagline.textContent = "åŒ¯ç‡å·²æ›´æ–°è‡ªç¶²è·¯ï¼Œåƒ…ä¾›åƒè€ƒã€‚è¼¸å…¥ä»»ä¸€æ¬„ï¼Œå¦ä¸€é‚Šæœƒè‡ªå‹•å¹«ä½ ç®—ã€‚";
            }
          } else {
            // æ›´æ–°å¤±æ•—ï¼šç¶­æŒåŸæœ¬æˆ–æ”¹æˆ 20
            if(isNaN(fxRate) || fxRate <= 0){
              fxRate = 20.0;
            }
            updateFxLabel(false);
            if(tagline){
              tagline.textContent = "åŒ¯ç‡æ›´æ–°å¤±æ•—ï¼Œæš«ä»¥ 20.00 è¨ˆç®—ã€‚ä»å¯è¼¸å…¥é‡‘é¡æ›ç®—ã€‚";
            }
          }
        })
        .catch(function(){
          if(isNaN(fxRate) || fxRate <= 0){
            fxRate = 20.0;
          }
          updateFxLabel(false);
          if(tagline){
            tagline.textContent = "åŒ¯ç‡æ›´æ–°å¤±æ•—ï¼Œæš«ä»¥ 20.00 è¨ˆç®—ã€‚ä»å¯è¼¸å…¥é‡‘é¡æ›ç®—ã€‚";
          }
        });
    }

    function initFx(){
      var audInput = document.getElementById("fx-aud");
      var twdInput = document.getElementById("fx-twd");
      var refreshBtn = document.getElementById("fx-refresh");
      var tagline = document.getElementById("fx-tagline");

      // å¾ localStorage è®€å–èˆŠåŒ¯ç‡
      var saved = localStorage.getItem("sydDiaryFxRate");
      if(saved){
        var r = parseFloat(saved);
        if(!isNaN(r) && r > 0){
          fxRate = r;
        }
      }
      updateFxLabel(true);
      if(tagline){
        tagline.textContent = "åŒ¯ç‡ç”±ç¶²è·¯æ›´æ–°ï¼Œåƒ…ä¾›åƒè€ƒã€‚è¼¸å…¥ä»»ä¸€æ¬„ï¼Œå¦ä¸€é‚Šæœƒè‡ªå‹•å¹«ä½ ç®—ã€‚";
      }

      function audChanged(){
        var aud = parseFloat(audInput.value || "0");
        if(fxRate > 0){
          twdInput.value = (aud * fxRate).toFixed(0);
        } else {
          twdInput.value = "";
        }
      }
      function twdChanged(){
        var twd = parseFloat(twdInput.value || "0");
        if(fxRate > 0){
          audInput.value = (twd / fxRate).toFixed(2);
        } else {
          audInput.value = "";
        }
      }

      audInput.addEventListener("input", audChanged);
      twdInput.addEventListener("input", twdChanged);

      refreshBtn.addEventListener("click", function(){
        fetchFxRate();
      });

      // ä¸€é€²é é¢å…ˆå˜—è©¦æ›´æ–°ä¸€æ¬¡
      fetchFxRate();
    }

    /* ========= è¡Œç¨‹è³‡æ–™ ========= */
    var trip = {
      name: "é›ªæ¢¨è·¨å¹´ 10 æ—¥éŠ",
      dateRange: "2025/12/23 â€“ 2026/01/02",
      days: [
        {
          id:"d0",
          label:"å‡ºç™¼æ—¥ï½œ12/23",
          theme:"æ™šç­æ©Ÿå‡ºç™¼",
          date:"2025/12/23",
          title:"å‡ºç™¼æ—¥ï½œTPE â†’ SYD",
          subtitle:"æ™šç­æ©Ÿé£›å¾€é›ªæ¢¨ï¼Œåœ¨æ©Ÿä¸Šä¼‘æ¯èª¿æ™‚å·®",
          stay:"æ©Ÿä¸Šéå¤œ",
          stayMap:"https://www.google.com/maps/place/Taiwan+Taoyuan+International+Airport",
          highCal:false,
          walk:3000,
          schedule:[
            {time:"20:30â€“22:30", title:"å‰å¾€æ¡ƒåœ’æ©Ÿå ´ãƒ»è¾¦ç†ç™»æ©Ÿ", detail:"æŠµé”æ©Ÿå ´è¾¦ç†å ±åˆ°ã€æ‰˜é‹è¡Œæï¼Œé€šé—œå¾Œæº–å‚™ç™»æ©Ÿã€‚", map:"https://www.google.com/maps/place/Taiwan+Taoyuan+International+Airport"},
            {time:"23:50", title:"23:50 TPE â†’ SYD", detail:"ä¸Šæ©Ÿå¾Œç›¡é‡ç¡è¦ºï¼Œèª¿æ•´æ™‚å·®ã€‚", map:""}
          ],
          meals:{
            breakfast:null,
            lunch:null,
            dinner:{name:"æ©Ÿå ´æˆ–æ©Ÿä¸Šé¤", type:"è¼•é£Ÿï¼é£›æ©Ÿé¤", note:"ä¾ç­æ©Ÿæ™‚é–“å½ˆæ€§ç”¨é¤ã€‚", reserve:false}
          }
        },
        {
          id:"d1",
          label:"Day 1ï½œ12/24",
          theme:"æŠµé”ãƒ»åŒ—é›ªæ¢¨æ¸¯ç£",
          date:"2025/12/24",
          title:"Day 1ï½œæŠµé”ï¼†åŒ—é›ªæ¢¨æ•£æ­¥",
          subtitle:"æŠµé”é›ªæ¢¨ï¼Œå…¥ä½ North Sydneyï¼Œä¸‹åˆæ¸¯ç£æ•£æ­¥",
          stay:"Citadines Walker North Sydney",
          stayMap:"https://www.google.com/maps/search/Citadines+Walker+North+Sydney",
          highCal:false,
          walk:8000,
          schedule:[
            {time:"12:15â€“13:30", title:"æŠµé”é›ªæ¢¨æ©Ÿå ´ SYD", detail:"ä¸‹æ©Ÿå¾Œé€šé—œã€é ˜è¡Œæã€éæª¢ç–«ã€‚", map:"https://www.google.com/maps/place/Sydney+Airport"},
            {time:"13:30â€“15:00", title:"å‰å¾€ Citadines Walker North Sydney", detail:"æ©Ÿå ´æ­ç«è»Š T8 â†’ Central â†’ è½‰ T1/T9 è‡³ North Sydneyï¼Œæ­¥è¡Œ 5â€“8 åˆ†é˜åˆ°é£¯åº—ã€‚", map:"https://www.google.com/maps/search/North+Sydney+Station"},
            {time:"15:30â€“17:30", title:"åŒ—é›ªæ¢¨æ¸¯ç£æ•£æ­¥", detail:"æ­¥è¡Œåˆ° Lavender Bayã€Wendyâ€™s Secret Gardenï¼Œå†åˆ° Kirribilliã€Bradfield Park æ‹å¤§æ©‹ï¼‹æ­ŒåŠ‡é™¢ç¶“å…¸è§’åº¦ã€‚", map:"https://www.google.com/maps/place/Wendy%27s+Secret+Garden"},
            {time:"18:30", title:"æ™šé¤", detail:"å»ºè­° Sails on Lavender Bayï¼ˆæµ·é®®ï¼‹ç‰›æ’ï¼‰æˆ– The Botanistï¼ˆå°é…’é¤¨ï¼‰ã€‚", map:""},
            {time:"21:00", title:"å›é£¯åº—ä¼‘æ¯", detail:"æ´—æ¾¡ã€æ—©é»ç¡ï¼Œèª¿æ•´æ™‚å·®ã€‚", map:""}
          ],
          meals:{
            breakfast:null,
            lunch:{name:"æ©Ÿä¸Šé¤é»", type:"é£›æ©Ÿé¤", note:"ä»¥å¢Šè‚šå­ç‚ºä¸»ï¼Œä¸‹æ©Ÿå¾Œå†å¥½å¥½åƒã€‚", reserve:false},
            dinner:{name:"Sails on Lavender Bay æˆ– The Botanist", type:"æµ·é®®ï¼å°é…’é¤¨", note:"è¦–é«”åŠ›èˆ‡é ç´„æƒ…æ³èª¿æ•´ã€‚", reserve:true}
          }
        },
        {
          id:"d2",
          label:"Day 2ï½œ12/25",
          theme:"è–èª•ç¯€æ•£æ­¥ç·š",
          date:"2025/12/25",
          title:"Day 2ï½œè–èª•ç¯€ãƒ»é›ªæ¢¨é»ƒé‡‘æ•£æ­¥ç·š",
          subtitle:"å¤è¹Ÿï¼‹æµ·ç£æ•£æ­¥ï¼Œåº—å®¶å¤šä¼‘æ¯ï¼Œé©åˆæ‹ç…§",
          stay:"Citadines Walker North Sydney",
          stayMap:"https://www.google.com/maps/search/Citadines+Walker+North+Sydney",
          highCal:true,
          walk:12000,
          schedule:[
            {time:"09:00â€“12:00", title:"City æ–‡åŒ–æ•£æ­¥", detail:"å¾ Wynyard / St James å‡ºç«™ï¼Œé€› Hyde Parkã€St Maryâ€™s Cathedralï¼Œæ²¿ Macquarie St çœ‹ Queenâ€™s Squareã€The Mintã€Hyde Park Barracksã€Il Porcellinoã€NSW Parliamentã€State Library of NSWã€‚", map:"https://www.google.com/maps/place/Hyde+Park+Sydney"},
            {time:"12:30â€“13:30", title:"åˆé¤ï¼šThe Rocks ä¸€å¸¶", detail:"æ¨è–¦ The Fine Food Storeï¼ˆæ—©åˆé¤ã€å’–å•¡ã€ä¸‰æ˜æ²»ï¼‰ã€‚", map:"https://www.google.com/maps/search/The+Fine+Food+Store+The+Rocks"},
            {time:"13:30â€“16:30", title:"æ¤ç‰©åœ’ï¼‹è§€æ™¯é»", detail:"é€² Royal Botanic Gardenï¼Œèµ°åˆ° Mrs Macquarieâ€™s Chair / Pointï¼Œæ²¿ Farm Cove æµ·é‚Šæ­¥é“èµ°å›æ­ŒåŠ‡é™¢å¤–åœæ‹ç…§ã€‚", map:"https://www.google.com/maps/place/Mrs+Macquarie%27s+Chair"},
            {time:"16:30â€“18:00", title:"Circular Quay / The Rocks è–èª•æ°£æ°›æ•£æ­¥", detail:"æ¸¯é‚Šèˆ‡è€è¡—æ•£æ­¥ã€æ„Ÿå—è–èª•æ°›åœã€‚", map:"https://www.google.com/maps/place/Circular+Quay"},
            {time:"18:30â€“20:00", title:"æ™šé¤ï¼šå› North Sydney ä¸€å¸¶", detail:"å¯å†åƒ The Botanist æˆ–é™„è¿‘ç‡Ÿæ¥­ä¸­çš„ pubã€‚", map:""}
          ],
          meals:{
            breakfast:{name:"City é™„è¿‘å’–å•¡å»³æ—©é¤", type:"æ—©åˆé¤ãƒ»å’–å•¡", note:"è–èª•ç¯€ç‡Ÿæ¥­åº—å®¶è¼ƒå°‘ï¼Œå»ºè­°å‰ä¸€å¤©ç¨å¾®æŸ¥å¥½ã€‚", reserve:false},
            lunch:{name:"The Fine Food Store", type:"æ—©åˆé¤ãƒ»å’–å•¡", note:"å¦‚æ“”å¿ƒå®¢æ»¿å¯ç¨æ—©åˆ°ã€‚", reserve:false},
            dinner:{name:"The Botanist æˆ– North Sydney pub", type:"å°é…’é¤¨ï¼é…’å§é¤é»", note:"è–èª•ç¯€ç‡Ÿæ¥­æ™‚é–“å¯èƒ½è¼ƒçŸ­ï¼Œå»ºè­°æå‰ç¢ºèªã€‚", reserve:true}
          }
        },
        {
          id:"d3",
          label:"Day 3ï½œ12/26",
          theme:"Boxing Day è³¼ç‰©",
          date:"2025/12/26",
          title:"Day 3ï½œBoxing Day è³¼ç‰©ï¼‹åŸå¸‚æ–‡åŒ–",
          subtitle:"å¤§æ¡è³¼æ—¥ï¼‹åšç‰©é¤¨",
          stay:"Citadines Walker North Sydney",
          stayMap:"https://www.google.com/maps/search/Citadines+Walker+North+Sydney",
          highCal:true,
          walk:11000,
          schedule:[
            {time:"09:30â€“14:00", title:"Pitt St Mall & ç™¾è²¨è³¼ç‰©", detail:"æ­ç«è»Šåˆ° Town Hallï¼Œé€› Pitt St Mallã€Westfieldã€QVBï¼Œè¶ Boxing Day å¤§æ¡è³¼ã€‚", map:"https://www.google.com/maps/place/Pitt+Street+Mall"},
            {time:"12:00â€“13:00", title:"åˆé¤ï¼šCity", detail:"å¯é¸ Mamakï¼ˆé¦¬ä¾†è¥¿äºæ–™ç†ï¼‰æˆ–ç™¾è²¨ç¾é£Ÿè¡—ã€‚", map:"https://www.google.com/maps/search/Mamak+Sydney"},
            {time:"14:30â€“17:30", title:"Hyde Park & Australian Museum", detail:"å› Hyde Parkï¼Œé€² Australian Museum çœ‹è‡ªç„¶æ­·å²èˆ‡æé¾å±•ã€‚", map:"https://www.google.com/maps/place/Australian+Museum"},
            {time:"18:30â€“20:00", title:"æ™šé¤ï¼šDarling Square ä¸€å¸¶", detail:"å¤šåœ‹æ–™ç†é›†ä¸­ï¼Œæ—¥å¼ã€éŸ“å¼ã€æ¼¢å ¡ç­‰ã€‚", map:"https://www.google.com/maps/place/Darling+Square"}
          ],
          meals:{
            breakfast:{name:"ä½å®¿é™„è¿‘ç°¡å–®æ—©é¤", type:"è¼•é£Ÿ", note:"", reserve:false},
            lunch:{name:"Mamak æˆ–ç™¾è²¨ç¾é£Ÿè¡—", type:"æ±å—äºæ–™ç†ï¼ç¾é£Ÿè¡—", note:"", reserve:false},
            dinner:{name:"Darling Square å¤šåœ‹æ–™ç†", type:"æ—¥å¼ï¼éŸ“å¼ï¼è¥¿å¼çš†å¯", note:"è¦–äººæ½®å½ˆæ€§æ’éšŠã€‚", reserve:false}
          }
        },
        {
          id:"d4",
          label:"Day 4ï½œ12/27",
          theme:"é­šå¸‚å ´ãƒ»éŠèˆ¹",
          date:"2025/12/27",
          title:"Day 4ï½œæ¬å®¶ãƒ»é­šå¸‚å ´ãƒ»é”ä»¤æ¸¯éŠèˆ¹æ™šé¤",
          subtitle:"åŒ—é›ªæ¢¨ â†’ Cityï¼Œé­šå¸‚å ´ï¼‹éŠèˆ¹æ™šé¤",
          stay:"Metro Hotel Marlow Sydney Central",
          stayMap:"https://www.google.com/maps/search/Metro+Hotel+Marlow+Sydney+Central",
          highCal:true,
          walk:9000,
          schedule:[
            {time:"09:30â€“10:30", title:"é€€æˆ¿ â†’ æ¬åˆ° Metro Hotel", detail:"å¾ Citadines é€€æˆ¿ï¼Œæ­ç«è»Šæˆ– Uber å‰å¾€ Central é™„è¿‘çš„ Metroï¼Œå…ˆå¯„æ”¾è¡Œæã€‚", map:"https://www.google.com/maps/search/Metro+Hotel+Marlow+Sydney+Central"},
            {time:"11:00â€“13:00", title:"Sydney Fish Market åˆé¤", detail:"åƒç”Ÿè ”ã€é¾è¦ã€é®­é­šæ¡å£½å¸ã€ç‚¸é­šè–¯æ¢ã€‚", map:"https://www.google.com/maps/place/Sydney+Fish+Market"},
            {time:"14:00â€“17:00", title:"Darling Harbour & City Walk", detail:"åœ¨ Darling Harbour ä¸€å¸¶æ•£æ­¥ï¼Œé€› Pyrmont Bridgeã€Harboursideã€King St Wharfã€‚", map:"https://www.google.com/maps/place/Darling+Harbour"},
            {time:"18:10â€“21:00", title:"é›ªæ¢¨æ¸¯ç²¾ç·»æ™šé¤éŠèˆ¹", detail:"æ–¼ SEA LIFE æ°´æ—é¤¨å‰ç¢¼é ­ç™»èˆ¹ï¼Œä¸‰é“å¼æ™šé¤ï¼‹æ¸¯ç£å¤œæ™¯ã€‚", map:"https://www.google.com/maps/place/SEA+LIFE+Sydney+Aquarium"},
            {time:"21:30", title:"å›é£¯åº—ä¼‘æ¯", detail:"çµæŸå¾Œæ­¥è¡Œæˆ–æ­è»Šå› Metroã€‚", map:""}
          ],
          meals:{
            breakfast:{name:"é€€æˆ¿å‰ç°¡å–®æ—©é¤", type:"è¼•é£Ÿ", note:"", reserve:false},
            lunch:{name:"Sydney Fish Market æµ·é®®å¤§é¤", type:"æµ·é®®", note:"äººå¤šæ™‚éœ€æ’éšŠæ‹¿é¤ã€‚", reserve:false},
            dinner:{name:"é”ä»¤æ¸¯ç²¾ç·»éŠèˆ¹æ™šé¤", type:"ä¸‰é“å¼æ™šé¤", note:"å·²äº‹å…ˆè³¼è²·è¡Œç¨‹ã€‚", reserve:true}
          }
        },
        {
          id:"d5",
          label:"Day 5ï½œ12/28",
          theme:"è—å±±ä¸€æ—¥éŠ",
          date:"2025/12/28",
          title:"Day 5ï½œè—å±±è‡ªç”±è¡Œ",
          subtitle:"è—å±±ä¸€æ—¥ï¼ŒScenic Worldï¼‹ä¸‰å§å¦¹å²©",
          stay:"Metro Hotel Marlow Sydney Central",
          stayMap:"https://www.google.com/maps/search/Metro+Hotel+Marlow+Sydney+Central",
          highCal:false,
          walk:13000,
          schedule:[
            {time:"07:30â€“09:30", title:"æ­ç«è»Šå‰å¾€è—å±±", detail:"Central æ­ Blue Mountains Line åˆ° Katoombaã€‚", map:"https://www.google.com/maps/place/Central+Station,+Sydney"},
            {time:"10:00â€“12:30", title:"Scenic World çºœè»Šä¸‰å¯¶", detail:"Skywayã€Railwayã€Cablewayï¼Œä¿¯ç°å±±è°·ã€‚", map:"https://www.google.com/maps/place/Scenic+World+Katoomba"},
            {time:"12:30â€“13:30", title:"åˆé¤", detail:"Scenic World CafÃ© æˆ– Katoomba å°é®ï¼ˆStation Bar / Yellow Deliï¼‰ã€‚", map:""},
            {time:"13:30â€“16:00", title:"Echo Point & æ­¥é“", detail:"çœ‹ä¸‰å§å¦¹å²©ï¼Œä¾é«”åŠ›èµ° Prince Henry Cliff Walkã€‚", map:"https://www.google.com/maps/place/Echo+Point+Lookout"},
            {time:"16:30â€“18:30", title:"æ­ç«è»Šå› Central", detail:"å›åˆ°å¸‚å€ï¼Œæ™šé¤å¾Œå›é£¯åº—ã€‚", map:""}
          ],
          meals:{
            breakfast:{name:"ç°¡å–®æ—©é¤ï¼å¤–å¸¶å’–å•¡", type:"è¼•é£Ÿ", note:"å¯åœ¨ Central é™„è¿‘è²·ã€‚", reserve:false},
            lunch:{name:"Scenic World CafÃ© æˆ– Katoomba é¤å»³", type:"è¥¿å¼é¤é»", note:"", reserve:false},
            dinner:{name:"Central ä¸€å¸¶ç°¡å–®æ™šé¤", type:"éš¨æ„é¤å»³", note:"", reserve:false}
          }
        },
        {
          id:"d6",
          label:"Day 6ï½œ12/29",
          theme:"çµäººè°·é…’èŠ",
          date:"2025/12/29",
          title:"Day 6ï½œçµäººè°·é…’èŠä¸€æ—¥éŠï¼ˆå·²è¨‚ï¼‰",
          subtitle:"è‘¡è„é…’ï¼‹èµ·å¸ç›¤çš„ä¸€å¤©",
          stay:"Metro Hotel Marlow Sydney Central",
          stayMap:"https://www.google.com/maps/search/Metro+Hotel+Marlow+Sydney+Central",
          highCal:true,
          walk:8000,
          schedule:[
            {time:"08:00â€“08:15", title:"èµ°è·¯è‡³ St Laurence Church é›†åˆ", detail:"å¾é£¯åº—æ­¥è¡Œç´„ 5 åˆ†é˜åˆ° 812 George Stã€‚", map:"https://www.google.com/maps/place/St+Laurence+Church+Sydney"},
            {time:"08:20â€“17:30", title:"çµäººè°·ä¸€æ—¥éŠè¡Œç¨‹", detail:"é€ è¨ª 3â€“4 é–“é…’èŠï¼Œå“é…’ã€èµ·å¸ç›¤ã€å·§å…‹åŠ›åº—ã€‚", map:"https://www.google.com/maps/search/Hunter+Valley+Wineries"},
            {time:"18:00â€“19:00", title:"å›åˆ° Central é™„è¿‘", detail:"è§£æ•£å¾Œå›é£¯åº—æˆ–å…ˆåƒæ™šé¤ã€‚", map:""},
            {time:"19:00", title:"æ™šé¤", detail:"å¯é¸å”äººè¡—ä¸­é¤æˆ–éŸ“å¼çƒ¤è‚‰ã€‚", map:""}
          ],
          meals:{
            breakfast:{name:"é£¯åº—é™„è¿‘ç°¡å–®æ—©é¤", type:"è¼•é£Ÿ", note:"å¯å¤–å¸¶åƒåœ¨è»Šä¸Šã€‚", reserve:false},
            lunch:{name:"çµäººè°·è¡Œç¨‹å…§é¤é£Ÿï¼å°é»", type:"åœ˜é«”é¤", note:"ä¾æ—…è¡Œç¤¾å®‰æ’ã€‚", reserve:true},
            dinner:{name:"å”äººè¡—ä¸­é¤æˆ–éŸ“å¼çƒ¤è‚‰", type:"ä¸­å¼ï¼éŸ“å¼", note:"è¦–é«”åŠ›æ±ºå®šæ˜¯å¦æ’éšŠã€‚", reserve:false}
          }
        },
        {
          id:"d7",
          label:"Day 7ï½œ12/30",
          theme:"å‹•ç‰©åœ’ãƒ»Watsons Bay",
          date:"2025/12/30",
          title:"Day 7ï½œTaronga Zoo ï¼‹ Watsons Bay ï¼‹ æ¬åˆ° Rydges",
          subtitle:"å‹•ç‰©åœ’ï¼‹æµ·æ™¯æ•£æ­¥ï¼Œå…¥ä½ Rydges Australia Square",
          stay:"Rydges Australia Squareï¼ˆ12/30â€“1/1ï¼‰",
          stayMap:"https://www.google.com/maps/search/Rydges+Australia+Square",
          highCal:false,
          walk:11000,
          schedule:[
            {time:"08:30â€“09:30", title:"é€€æˆ¿ â†’ è¡Œæå¸¶å» Rydges å¯„æ”¾", detail:"å¾ Metro æ¬åˆ° Rydgesï¼Œä¸èƒ½å…¥ä½å°±å…ˆå¯„æ”¾è¡Œæã€‚", map:"https://www.google.com/maps/search/Rydges+Australia+Square"},
            {time:"09:30â€“13:00", title:"Taronga Zoo å‹•ç‰©åœ’", detail:"å¾ Circular Quay æ­æ¸¡è¼ªåˆ°å‹•ç‰©åœ’ï¼Œçœ‹ç„¡å°¾ç†Šã€è¢‹é¼ ç­‰ã€‚", map:"https://www.google.com/maps/place/Taronga+Zoo+Sydney"},
            {time:"13:30â€“17:30", title:"Watsons Bay æµ·æ™¯ï¼‹æ­¥é“", detail:"æ­æ¸¡è¼ªåˆ° Watsons Bayï¼Œèµ° South Head Heritage Walkã€Gap Bluff çœ‹æµ·æ™¯ã€‚", map:"https://www.google.com/maps/place/Watsons+Bay"},
            {time:"17:30â€“19:00", title:"æ™šé¤ï¼šDoyleâ€™s on the Beach", detail:"ç¶“å…¸æµ·é®®ï¼Œç‚¸é­šè–¯æ¢ã€æµ·é®®æ‹¼ç›¤ã€‚", map:""},
            {time:"19:00â€“20:00", title:"æ¸¡è¼ªå› Circular Quay â†’ å› Rydges è¾¦ç† Check-in", detail:"å› City æ­£å¼å…¥ä½ Rydgesã€‚", map:""}
          ],
          meals:{
            breakfast:{name:"é™„è¿‘å’–å•¡å»³ç°¡å–®æ—©é¤", type:"å’–å•¡ãƒ»æ—©åˆé¤", note:"", reserve:false},
            lunch:{name:"å‹•ç‰©åœ’å…§é¤å»³æˆ–è¼•é£Ÿ", type:"åœ’å€é¤é»", note:"", reserve:false},
            dinner:{name:"Doyleâ€™s on the Beach", type:"æµ·é®®é¤å»³", note:"å»ºè­°æå‰é ç´„æµ·æ™¯ä½ã€‚", reserve:true}
          }
        },
        {
          id:"d8",
          label:"Day 8ï½œ12/31",
          theme:"æ­ŒåŠ‡é™¢ãƒ»è·¨å¹´",
          date:"2025/12/31",
          title:"Day 8ï½œè·¨å¹´ãƒ»æ­ŒåŠ‡é™¢æ­ŒåŠ‡ï¼‹After Party",
          subtitle:"ç™½å¤©å¸‚å€æ¼«æ­¥ï¼Œæ™šä¸Šæ­ŒåŠ‡ï¼‹ç…™ç«",
          stay:"Rydges Australia Square",
          stayMap:"https://www.google.com/maps/search/Rydges+Australia+Square",
          highCal:true,
          walk:9000,
          schedule:[
            {time:"10:30â€“14:00", title:"Barangaroo & Millers Point æ•£æ­¥", detail:"èµ° Barangaroo Reserveã€Millers Pointã€Observatory Hill çœ‹å¤§æ©‹ã€‚", map:"https://www.google.com/maps/place/Barangaroo+Reserve"},
            {time:"12:30â€“13:30", title:"åˆé¤", detail:"åœ¨ Barangaroo æˆ– City é¤å»³ç”¨é¤ã€‚", map:""},
            {time:"14:00â€“16:30", title:"å›é£¯åº—ä¼‘æ¯ãƒ»æº–å‚™è·¨å¹´", detail:"æ´—æ¾¡ã€æ‰“æ‰®ã€æ•´ç†è·¨å¹´ç”¨å“ã€‚", map:""},
            {time:"17:30â€“18:30", title:"æ­ŒåŠ‡é™¢é™„è¿‘è¼•é£Ÿ", detail:"å…ˆåƒé»å°æ±è¥¿ï¼Œé¿å…æ¼”å‡ºå¾Œå¤ªé¤“ã€‚", map:""},
            {time:"19:00â€“22:00", title:"Sydney Opera House æ­ŒåŠ‡æ¼”å‡ºï¼ˆå·²è¨‚ï¼‰", detail:"ä¾ç¥¨åˆ¸åº§ä½å…¥å ´æ¬£è³æ¼”å‡ºã€‚", map:"https://www.google.com/maps/place/Sydney+Opera+House"},
            {time:"22:00â€“00:30", title:"After Party + è·¨å¹´ç…™ç«", detail:"å…§å«é£²å“ã€å°é»ï¼Œåˆå¤œå€’æ•¸çœ‹æ¸¯ç£ç…™ç«ã€‚", map:""},
            {time:"00:30â€“01:00", title:"æ­¥è¡Œå› Rydges", detail:"æ­¥è¡Œ 10â€“15 åˆ†é˜å›é£¯åº—ã€‚", map:""}
          ],
          meals:{
            breakfast:{name:"é£¯åº—é™„è¿‘ç°¡å–®æ—©é¤", type:"è¼•é£Ÿ", note:"", reserve:false},
            lunch:{name:"Barangaroo / City é¤å»³", type:"ç¾ä»£æ¾³å¼ï¼æ—¥å¼ï¼æ³°å¼", note:"", reserve:false},
            dinner:{name:"æ­ŒåŠ‡é™¢å‰è¼•é£Ÿï¼‹After Party é»å¿ƒ", type:"è¼•é£Ÿï¼‹æ´¾å°é¤é»", note:"ä¾ç¥¨åˆ¸å…§å®¹ç‚ºä¸»ã€‚", reserve:true}
          }
        },
        {
          id:"d9",
          label:"Day 9ï½œ1/1",
          theme:"æœ€å¾Œæ•£æ­¥ãƒ»å›ç¨‹",
          date:"2026/01/01",
          title:"Day 9ï½œæœ€å¾ŒåŠå¤©ï¼†å›ç¨‹",
          subtitle:"è·¨å¹´å¾Œç¡é£½ã€æœ€å¾Œæ•£æ­¥ï¼Œæ™šä¸Šé£›å›å°ç£",
          stay:"Rydges Australia Squareï¼ˆæ—©ä¸Šé€€æˆ¿ï¼‰",
          stayMap:"https://www.google.com/maps/search/Rydges+Australia+Square",
          highCal:false,
          walk:8000,
          schedule:[
            {time:"09:30â€“11:00", title:"ç¡åˆ°è‡ªç„¶é†’ãƒ»æ—©é¤", detail:"åœ¨é£¯åº—é™„è¿‘è¼•é¬†åƒæ—©é¤ã€‚", map:""},
            {time:"11:00â€“11:30", title:"é€€æˆ¿ãƒ»å¯„æ”¾è¡Œæ", detail:"11:00 å‰é€€æˆ¿ä¸¦å¯„æ”¾è¡Œæã€‚", map:""},
            {time:"11:30â€“15:00", title:"æœ€å¾Œæ•£æ­¥ï¼‹Brunch", detail:"City è£œè²¨æˆ–å» Newtown / Redfern æ—©åˆé¤ï¼‹é€›å°åº—ã€‚", map:"https://www.google.com/maps/search/Three+Williams+Sydney"},
            {time:"15:30â€“16:00", title:"å›é£¯åº—æ‹¿è¡Œæ", detail:"å› Rydges é ˜å›è¡Œæã€‚", map:""},
            {time:"16:00â€“18:00", title:"å‰å¾€æ©Ÿå ´", detail:"æ­ç«è»Š Airport Link æˆ–æ©Ÿå ´å·´å£«åˆ° SYDã€‚", map:"https://www.google.com/maps/place/Sydney+Airport"},
            {time:"20:00", title:"20:00 SYD â†’ TPE", detail:"è¾¦ç†ç™»æ©Ÿã€æ­æ©Ÿå›å°ç£ã€‚", map:""}
          ],
          meals:{
            breakfast:{name:"é£¯åº—é™„è¿‘æ—©é¤ï¼å’–å•¡å»³", type:"è¼•é£Ÿ", note:"", reserve:false},
            lunch:{name:"City æˆ– Newtown / Redfern æ—©åˆé¤", type:"æ—©åˆé¤", note:"", reserve:false},
            dinner:{name:"æ©Ÿå ´ï¼æ©Ÿä¸Šé¤é»", type:"æ©Ÿå ´é¤ï¼é£›æ©Ÿé¤", note:"", reserve:false}
          }
        },
        {
          id:"d10",
          label:"å›å®¶æ—¥ï½œ1/2",
          theme:"æŠµé”å°ç£",
          date:"2026/01/02",
          title:"å›å®¶æ—¥ï½œæŠµé”å°ç£",
          subtitle:"æ¸…æ™¨æŠµé”å°ç£ï¼Œå›å®¶ä¼‘æ¯",
          stay:"ç”œç”œçš„å®¶",
          stayMap:"https://www.google.com/maps/place/Taiwan+Taoyuan+International+Airport",
          highCal:false,
          walk:4000,
          schedule:[
            {time:"05:50â€“08:00", title:"æŠµé”æ¡ƒåœ’æ©Ÿå ´ãƒ»å…¥å¢ƒ", detail:"é ˜è¡Œæã€é€šé—œã€æ­è»Šå›å®¶ã€‚", map:"https://www.google.com/maps/place/Taiwan+Taoyuan+International+Airport"},
            {time:"08:00 ä¹‹å¾Œ", title:"å›å®¶æ•´ç†è¡Œæãƒ»å¥½å¥½ä¼‘æ¯", detail:"æ´—æ¾¡ã€æ´—è¡£æœã€æ•´ç†æˆ°åˆ©å“ã€‚", map:""}
          ],
          meals:{
            breakfast:{name:"æ©Ÿä¸Šç°¡å–®æ—©é¤æˆ–å›å®¶å¾Œå†åƒ", type:"è¼•é£Ÿ", note:"", reserve:false},
            lunch:{name:"å®¶é™„è¿‘æˆ–å¤–é€", type:"éš¨æ„", note:"", reserve:false},
            dinner:{name:"å®¶å¸¸æ™šé¤", type:"åœ¨å®¶ç…®ï¼å¤–å¸¶", note:"", reserve:false}
          }
        }
      ]
    };

    /* ========= æ¸²æŸ“ ========= */
    var dayListEl   = document.getElementById("day-list");
    var dayHeaderEl = document.getElementById("day-header");
    var dayScheduleEl = document.getElementById("day-schedule");
    var dayMealsEl  = document.getElementById("day-meals");
    var currentDayIndex = 0;

    function initDayList(){
      dayListEl.innerHTML = "";
      for(var i=0;i<trip.days.length;i++){
        var d = trip.days[i];
        var li = document.createElement("li");
        li.className = "day-list-item" + (i===0 ? " active" : "");
        li.setAttribute("data-index", i);

        // ğŸ‘‰ æ–°ç‰ˆï¼šä¸å†åŠ æ‹¬å¼§ï¼Œè€Œæ˜¯ç”¨ã€Œï½œã€ä¸²èµ·ä¾†
        var textLeft = d.label;        // å‡ºç™¼æ—¥ï½œ12/23 æˆ– Day 1ï½œ12/24
var parts = textLeft.split("ï½œ");
var col1 = parts[0] || "";
var col2 = parts[1] || "";
var col3 = d.theme || "";

// ç”¨ä¸‰å€‹ span å¡åˆ°ä¸‰æ¬„
li.innerHTML =
  '<span>'+ col1 +'</span>' +
  '<span>'+ col2 +'</span>' +
  '<span>'+ col3 +'</span>';

        li.addEventListener("click", function(){
          var idx = parseInt(this.getAttribute("data-index"),10);
          currentDayIndex = idx;
          updateDayListActive();
          renderDay(idx);
        });
        dayListEl.appendChild(li);
      }
    }

    function updateDayListActive(){
      var items = dayListEl.querySelectorAll(".day-list-item");
      for(var i=0;i<items.length;i++){
        items[i].classList.toggle("active", i === currentDayIndex);
      }
    }

    function renderDay(index){
      var d = trip.days[index];

      // Header
      var bannerHTML = '';
      bannerHTML += '<div class="day-banner">';
      bannerHTML +=   '<div>';
      bannerHTML +=     '<span class="banner-label">ğŸ¨ ä»Šæ™šä½å®¿</span>';
      bannerHTML +=     '<span class="banner-hotel-name">'+ d.stay +'</span>';
      if(d.stayMap){
        bannerHTML +=   '<a class="banner-hotel-link" href="'+ d.stayMap +'" target="_blank" rel="noopener noreferrer">';
        bannerHTML +=     '<span class="icon-map"></span><span>åœ°åœ–</span>';
        bannerHTML +=   '</a>';
      }
      bannerHTML +=   '</div>';
      bannerHTML += '</div>';

      var badges = '';
      if(d.highCal){
        badges += '<span class="badge badge-highcal">ğŸ° é«˜ç†±é‡æ—¥</span>';
      }
      badges += '<span class="badge">ğŸš¶ ç›®æ¨™ '+ d.walk.toLocaleString() +' æ­¥</span>';

      dayHeaderEl.innerHTML =
        bannerHTML +
        '<div class="day-title">'+ d.title +'</div>'+
        '<div class="day-subtitle">'+ d.subtitle +'</div>'+
        '<div class="badge-row">'+ badges +'</div>';

      // Schedule
      dayScheduleEl.innerHTML = '<div class="section-title">ğŸ“‹ è¡Œç¨‹æ™‚é–“è»¸</div>';
      for(var i=0;i<d.schedule.length;i++){
        var b = d.schedule[i];
        var row = document.createElement("div");
        row.className = "schedule-row";
        var mapHtml = '';
        if(b.map){
          mapHtml = '<a href="'+b.map+'" target="_blank" rel="noopener noreferrer"><span class="icon-map"></span> åœ°åœ–</a>';
        }
        row.innerHTML =
          '<div class="time-cell">'+ b.time +'</div>'+
          '<div>'+
            '<div class="block-title">'+ b.title +'</div>'+
            '<div class="block-detail">'+ (b.detail||"") +'</div>'+
            '<div class="block-meta">'+ (mapHtml || '') +'</div>'+
          '</div>';
        dayScheduleEl.appendChild(row);
      }

      // Meals
      dayMealsEl.innerHTML = '<div class="section-title">ğŸ½ï¸ ä»Šæ—¥ä¸‰é¤</div>';
      var wrap = document.createElement("div");
      wrap.className = "meals-grid";
      var order = [["breakfast","æ—©é¤"],["lunch","åˆé¤"],["dinner","æ™šé¤"]];
      for(var j=0;j<order.length;j++){
        var key = order[j][0], label = order[j][1];
        var card = document.createElement("div");
        card.className = "meal-card";
        var meal = d.meals[key];
        if(meal){
          var tagClass = meal.reserve ? "meal-tag meal-tag-reserve" : "meal-tag";
          var tagText  = meal.reserve ? "ğŸ“… å»ºè­°é ç´„" : "ğŸ™‚ ä¸éœ€é ç´„";
          card.innerHTML =
            '<div class="meal-title">'+ label +'</div>'+
            '<div class="meal-restaurant">'+ meal.name +'</div>'+
            '<div class="meal-note">é¡å‹ï¼š'+ (meal.type||"â€”")+'<br>'+ (meal.note||"") +'</div>'+
            '<div class="'+tagClass+'">'+ tagText +'</div>';
        }else{
          card.innerHTML =
            '<div class="meal-title">'+ label +'</div>'+
            '<div class="meal-note" style="font-size:12px;color:var(--text-muted);">å°šæœªå®‰æ’ã€‚</div>';
        }
        wrap.appendChild(card);
      }
      dayMealsEl.appendChild(wrap);
    }

    /* ========= å´é‚Šæ¬„æ”¶åˆ ========= */
    function initSidebarToggle(){
      var toggle = document.getElementById("sidebar-toggle");
      var sidebar = document.getElementById("sidebar");
      var overlay = document.getElementById("sidebar-overlay");

      function openSidebar(){
        sidebar.classList.add("open");
        overlay.classList.add("active");
      }
      function closeSidebar(){
        sidebar.classList.remove("open");
        overlay.classList.remove("active");
      }

      toggle.addEventListener("click", function(){
        if(sidebar.classList.contains("open")){
          closeSidebar();
        }else{
          openSidebar();
        }
      });
      overlay.addEventListener("click", closeSidebar);
    }

    /* ========= INIT ========= */
    initThemeUI();
    initFx();
    initDayList();
    renderDay(0);
    updateTimes();
    setInterval(updateTimes, 1000);
    fetchSydneyWeather();
    setInterval(fetchSydneyWeather, 10*60*1000);
    initSidebarToggle();
  </script>
</body>
</html>
